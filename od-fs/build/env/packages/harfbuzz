#!/bin/sh
# --------------------------------------------------------------------------------------------------
set -e
# --------------------------------------------------------------------------------------------------

"$BUILD_ENV_DIR/packages/freetype-noharfbuzz"
"$BUILD_ENV_DIR/packages/glib"

PACKAGE=harfbuzz-11.0.0
PACKAGE_REVISION=0
CHECKSUM=f16351bafe214725fe2c1d5b59f0d93e49905a4b247899fb90d70cff953a2b9b

# --------------------------------------------------------------------------------------------------
. "$PACKAGE_PRE"
# --------------------------------------------------------------------------------------------------

"$BUILD_ENV_DIR/scripts/download.py" \
https://github.com/harfbuzz/harfbuzz/releases/download/11.0.0/$PACKAGE.tar.xz \
sha256:$CHECKSUM

tar xf "$BUILD_ENV_DIR/_sources/$PACKAGE.tar.xz"
cd $PACKAGE

##meson build
##ninja -Cbuild
##meson test -Cbuild

meson setup --prefix $PREFIX --libdir lib _build
meson compile -C _build
meson install -C _build

# if [ "$SYSTEM_OS" = "macOS" ]; then
# DYLIB=libharfbuzz.0.dylib
# install_name_tool -id @rpath/$DYLIB $PREFIX/lib/$DYLIB
# fi

# --------------------------------------------------------------------------------------------------
. "$PACKAGE_POST"
# --------------------------------------------------------------------------------------------------
