#!/usr/bin/env python3
# This file is automatically generated by fs-package

import os
import sys

sys.path.insert(0, ".")
from fsbuild import getBundlePath, getPackageInformation, isMacOS, runCodeSign


def main():
    if getPackageInformation().type == "fs-data-plugin":
        print("Not signing data plugin")
    elif isMacOS():
        args = [
            "codesign",
            "--force",
            "--deep",
            "--options",
            "runtime",
            "--sign",
            "Developer ID Application",
            "--digest-algorithm=sha1,sha256",
        ]
        if os.path.exists("fsbuild/Entitlements.plist"):
            args.extend(["--entitlements", "fsbuild/Entitlements.plist"])
        args.append(getBundlePath())
        runCodeSign(args)
    else:
        print("Skipping sign step (No signatures for this platform")


if __name__ == "__main__":
    main()
