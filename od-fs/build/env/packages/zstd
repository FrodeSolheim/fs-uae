#!/bin/sh
# --------------------------------------------------------------------------------------------------
set -e
# --------------------------------------------------------------------------------------------------

PACKAGE=zstd-1.5.7
PACKAGE_REVISION=1
PACKAGE_URL=https://github.com/facebook/zstd/releases/download/v1.5.7/zstd-1.5.7.tar.gz
PACKAGE_CHECKSUM=eb33e51f49a15e023950cd7825ca74a4a2b43db8354825ac24fc1b7ee09e6fa3

# --------------------------------------------------------------------------------------------------
. "$PACKAGE_PRE"
# --------------------------------------------------------------------------------------------------

tar xf "$PACKAGE_SOURCES/$PACKAGE.tar.gz"
cd $PACKAGE
cd build/cmake

cmake -S . -B _build
cmake --build _build
cmake --install _build --prefix "$PACKAGE_PREFIX"

if [ "$SYSTEM_OS" = "macOS" ]; then
DYLIB=libzstd.1.dylib
install_name_tool -id "$PACKAGE_PREFIX/lib/$DYLIB" "$PACKAGE_PREFIX/lib/$DYLIB"
fi

# --------------------------------------------------------------------------------------------------
. "$PACKAGE_POST"
# --------------------------------------------------------------------------------------------------
